<!-- Main View Canvas -->
<div class="w-full px-6 py-8 bg-white border-b border-gray-100 mt-12">
  <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
    <div>
      <h1 class="text-2xl font-bold text-gray-900 tracking-tight">My Advertisement</h1>
      <p class="mt-1 text-sm text-gray-500">
        <span *ngIf="ad_type === 'container'">Manage your container advertisements and leads</span>
        <span *ngIf="ad_type === 'space'">Manage your vessel space advertisements and leads</span>
      </p>
    </div>

    <div class="flex items-center space-x-3">
      <button (click)="onExportClick()" class="action-btn action-btn-secondary space-x-2">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M13 12V14H3V12H2V14L2.0038 13.9976C2.00333 14.1288 2.02873 14.2589 2.07854 14.3803C2.12836 14.5017 2.20163 14.6121 2.29414 14.7052C2.38666 14.7983 2.49662 14.8723 2.61774 14.9229C2.73885 14.9734 2.86875 14.9997 3 15H13C13.2652 15 13.5196 14.8946 13.7071 14.7071C13.8946 14.5196 14 14.2652 14 14V12H13Z"
            fill="currentColor" />
          <path d="M3 6L3.7055 6.7025L7.5 2.9125V12H8.5V2.9125L12.2955 6.7025L13 6L8 1L3 6Z" fill="currentColor" />
        </svg>
        <span>Export</span>
      </button>
      <button [disabled]="isButtonDisabled" (click)="DisplayPostForm()" class="action-btn action-btn-primary">
        <span>Post Ad</span>
      </button>
    </div>
  </div>
</div>


<div class="flex justify-end pr-10 py-4">
  <button (click)="downloadTemplate()" class="action-btn action-btn-secondary">
    <span>Download Template</span>
  </button>
</div>

<hr style="height: 2px;">

<nav *ngIf="ad_type==='container'" class="bg-white mb-6">
  <ul class="nav-tabs">
    <li class="tab-item" [class.tab-item-active]="Active">
      <button (click)="onViewActive()" *ngIf="ad_type === 'container'" class="flex items-center">
        <span>Active Ads</span>
        <span class="tab-count">{{ ad_type === 'container' ? originalcontaineractiveAds : originalspaceactiveAds
          }}</span>
      </button>
    </li>
    <li class="tab-item" [class.tab-item-active]="pendingActive">
      <button (click)="onPendingActive()" *ngIf="ad_type === 'container'" class="flex items-center">
        <span>Pending Ads</span>
        <span class="tab-count">{{this.originalcontainerpendingAds}}</span>
      </button>
    </li>
    <li class="tab-item" [class.tab-item-active]="draftActive">
      <button (click)="onDraftsActive()" *ngIf="ad_type === 'container'" class="flex items-center">
        <span>Draft Ads</span>
        <span class="tab-count">{{this.originalcontainerdraftAds}}</span>
      </button>
    </li>
  </ul>
</nav>

<nav *ngIf="ad_type==='space'" class="bg-white mb-6">
  <ul class="nav-tabs">
    <li class="tab-item" [class.tab-item-active]="Active">
      <button (click)="onViewActive()" *ngIf="ad_type === 'space'" class="flex items-center">
        <span>Active Ads</span>
        <span class="tab-count">{{ this.ad_type === 'space' ? originalspaceactiveAds : originalcontaineractiveAds
          }}</span>
      </button>
    </li>
    <li class="tab-item" [class.tab-item-active]="pendingActive">
      <button (click)="onPendingActive()" *ngIf="ad_type === 'space'" class="flex items-center">
        <span>Pending Ads</span>
        <span class="tab-count">{{this.originalspacependingAds}}</span>
      </button>
    </li>
    <li class="tab-item" [class.tab-item-active]="draftActive">
      <button (click)="onDraftsActive()" *ngIf="ad_type === 'space'" class="flex items-center">
        <span>Draft Ads</span>
        <span class="tab-count">{{this.originalspacedraftAds}}</span>
      </button>
    </li>
  </ul>
</nav>


<div class="w-full flex flex-col first:flex-row max-h-screen bg-gray-50">
  <section class="ml-4 mr-6 rounded-sm">
    <div class="flex flex-col">
      <div class="overflow-hidden rounded-lg  border-1  mr-0 mt-4">
        <table class="modern-table">
          <thead>
            <tr>
              <th scope="col">Expiry Date</th>
              <th scope="col">Type of Ad</th>
              <th scope="col">Status</th>
              <th scope="col">Price</th>
              <th scope="col">Quality</th>
              <th scope="col">Free days</th>
              <th scope="col">Per Diem</th>
              <th scope="col">Pickup charges</th>
              <th scope="col">
                {{ ad_type === 'container' ? 'Port of Ad' : 'Port of Departure' }}
              </th>
              <th scope="col" *ngIf="ad_type === 'container'">Port of Departure</th>
              <th scope="col" *ngIf="ad_type === 'container'">Port of Arrival</th>
              <th scope="col" *ngIf="ad_type === 'container'">Negotiations</th>
              <th scope="col" *ngIf="ad_type === 'space'">Port of Arrival</th>
              <th scope="col" *ngIf="ad_type === 'space' && operation === 'Active'">Negotiations</th>
              <th scope="col" *ngIf="ad_type === 'space' && operation !== 'Active'">Actions</th>
            </tr>
          </thead>
          <!-- <div class="flex flex-col text-[0.6rem]">
                      <div class="flex flex-row gap-2">
                        <div class="flex flex-col" *ngIf="ad_type === 'container'">
                          <div>
                            <i class="material-icons mr-1 text-xs">place</i
                            >Port of Ad
                          </div>
                          <div class="gray-highlights" >
                            {{ ad.port_of_ad }}
                          </div>
                        </div>
                        <div class="flex flex-col" *ngIf="ad_type !== 'container'">
                          <div>
                            <i class="material-icons mr-1 text-xs">place</i
                            >Departure
                          </div>
                          <div class="gray-highlights" >
                            {{ ad.port_of_departure }}
                          </div>
                        </div>
                        <div class="flex flex-col" *ngIf="ad_type !== 'container'">
                          <div>
                            <i class="material-icons mr-1 text-xs">place</i
                            >Arrival
                          </div>
                          <div>
                            <div class="flex flex-row gap-1">
                              <div class="gray-highlights">
                                {{ ad.port_of_arrival }}
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div> -->
          <tbody class="divide-y divide-gray-100">
            <tr *ngFor="let ad of ads | paginate: { itemsPerPage: itemsPerPage, currentPage: currentPage }">
              <td>{{ getDateOnly(ad.expiry_date) }}</td>
              <td class="capitalize">{{ ad.type_of_ad }}</td>
              <td>
                <span class="status-badge"
                  [ngClass]="ad.status === 'active' ? 'status-badge-active' : 'status-badge-inactive'">
                  {{ ad.status }}
                </span>
              </td>
              <td class="font-medium text-gray-900">{{ ad.price | currency:'USD':'symbol':'1.0-2' }}</td>
              <td>{{ ad.quantity }}</td>
              <td>{{ ad.free_days }}</td>
              <td>{{ ad.per_diem }}</td>
              <td>{{ ad.pickup_charges }}</td>
              <td>
                <ng-container *ngIf="ad_type === 'container'">
                  <span class="text-gray-500">{{ ad.port_of_ad }}</span>
                </ng-container>
                <ng-container *ngIf="ad_type !== 'container'">
                  <span class="text-gray-500">{{ ad.port_of_departure }}</span>
                </ng-container>
              </td>
              <td *ngIf="ad_type !== 'container'">
                <span class="text-gray-500">{{ ad.port_of_arrival }}</span>
              </td>
              <td *ngIf="ad_type == 'container'">
                <span class="text-gray-500">{{ ad.port_of_departure }}</span>
              </td>
              <td *ngIf="ad_type == 'container'">
                <span class="text-gray-500">{{ ad.port_of_arrival }}</span>
              </td>

              <td class="whitespace-nowrap">
                <div class="flex items-center space-x-2">
                  <button (click)="DisplayDraftForm(ad.ad_id)" *ngIf="operation === 'Draft'"
                    class="action-btn action-btn-primary">Edit</button>
                  <button (click)="approve(ad.ad_id)" *ngIf="operation === 'Pending'"
                    class="action-btn action-btn-primary">Approve</button>
                  <button [disabled]="getNegotiationCount(ad.ad_id) < 1" (click)="OpenNegotiations(ad.ad_id,ad_type)"
                    *ngIf="operation === 'Active'" class="action-btn action-btn-secondary"
                    [title]="getNegotiationCount(ad.ad_id) < 1 ? 'No negotiations yet' : 'Open negotiations'">
                    Open ({{ getNegotiationCount(ad.ad_id) }})
                  </button>
                  <button (click)="deleteAd(ad.ad_id)" class="delete-btn" title="Delete Ad">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                      stroke-linecap="round" stroke-linejoin="round">
                      <path d="M3 6h18"></path>
                      <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path>
                      <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>
                      <line x1="10" y1="11" x2="10" y2="17"></line>
                      <line x1="14" y1="11" x2="14" y2="17"></line>
                    </svg>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>

        <div class="flex items-center justify-between border-t border-gray-100 bg-white px-4 py-3 sm:px-6 mt-4">
          <div class="flex flex-1 justify-between sm:hidden">
            <button (click)="prevPage()" [disabled]="currentPage === 1"
              class="action-btn action-btn-secondary">Previous</button>
            <button (click)="nextPage()" [disabled]="currentPage === totalPages"
              class="action-btn action-btn-secondary ml-3">Next</button>
          </div>
          <div class="hidden sm:flex sm:flex-1 sm:items-center sm:justify-between">
            <div>
              <p class="text-sm text-gray-700">
                Showing page <span class="font-medium">{{currentPage}}</span> of <span
                  class="font-medium">{{totalPages}}</span>
              </p>
            </div>
            <div>
              <nav class="isolate inline-flex -space-x-px rounded-md shadow-sm" aria-label="Pagination">
                <button (click)="prevPage()" [disabled]="currentPage === 1"
                  class="relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-30">
                  <span class="sr-only">Previous</span>
                  <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                    <path fill-rule="evenodd"
                      d="M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z"
                      clip-rule="evenodd" />
                  </svg>
                </button>

                <button *ngIf="currentPage > 1" (click)="prevPage()"
                  class="relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0">
                  {{currentPage - 1}}
                </button>

                <span
                  class="relative z-10 inline-flex items-center bg-blue-600 px-4 py-2 text-sm font-semibold text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600">
                  {{currentPage}}
                </span>

                <button *ngIf="currentPage < totalPages" (click)="nextPage()"
                  class="relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0">
                  {{currentPage + 1}}
                </button>

                <button (click)="nextPage()" [disabled]="currentPage === totalPages"
                  class="relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-30">
                  <span class="sr-only">Next</span>
                  <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                    <path fill-rule="evenodd"
                      d="M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z"
                      clip-rule="evenodd" />
                  </svg>
                </button>
              </nav>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>